<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø­Ø§Ø³Ø¨Ø© ØºØ±Ø§Ù…Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±</title>

<style>
body {
    font-family: Tahoma, sans-serif;
    background: linear-gradient(to right, #4e54c8, #8f94fb);
    color: #fff;
    text-align: center;
    padding: 40px;
}
h1 {
    margin-bottom: 30px;
}
input, select, button {
    padding: 10px;
    margin: 8px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
}
button {
    background: #ffcc00;
    font-weight: bold;
    cursor: pointer;
}
button:hover {
    background: #ffe066;
}
.result {
    margin-top: 20px;
    font-size: 18px;
    font-weight: bold;
}
.note {
    font-size: 14px;
    color: #ffeaa7;
}
</style>
</head>

<body>

<h1>Ø­Ø§Ø³Ø¨Ø© ØºØ±Ø§Ù…Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±</h1>

<label>ØªØ§Ø±ÙŠØ® ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯ / Ø´Ø±Ø§Ø¡ Ø§Ù„ÙˆØ­Ø¯Ø©:</label><br>
<input type="date" id="purchaseDate"><br>

<label>Ù†ÙˆØ¹ Ø§Ù„Ø´Ù‚Ø©:</label><br>
<select id="apartmentType">
    <option value="">-- Ø§Ø®ØªØ± --</option>
    <option value="2+1">2 + 1</option>
    <option value="3+1">3 + 1</option>
</select><br>

<label>Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± (Ø¯ÙŠÙ†Ø§Ø±):</label><br>
<input type="number" id="exchangeRate" placeholder="Ù…Ø«Ø§Ù„: 1320"><br>

<label>Ø§Ù„ØºØ±Ø§Ù…Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©:</label><br>
<input type="number" id="monthlyFine" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„ØºØ±Ø§Ù…Ø©"><br>

<select id="currency">
    <option value="USD">Ø¯ÙˆÙ„Ø§Ø±</option>
    <option value="IQD">Ø¯ÙŠÙ†Ø§Ø±</option>
</select><br>

<button onclick="calculate()">Ø§Ø­Ø³Ø¨ Ø§Ù„ØºØ±Ø§Ù…Ø§Øª</button>

<div class="result" id="result"></div>

<div id="stopSection" style="display:none;">
    <label>Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„ØªÙˆÙ‚Ù:</label><br>
    <input type="number" id="stopDays" value="0"><br>
    <button onclick="applyStopDays()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
    <div class="result" id="finalResult"></div>
</div>

<script>
let dailyFineIQD = 0;
let baseAmount = 0;

function calculate() {
    const purchaseDate = new Date(document.getElementById("purchaseDate").value);
    const targetDate = new Date("2026-01-01");
    const rate = parseFloat(document.getElementById("exchangeRate").value);
    const monthlyFine = parseFloat(document.getElementById("monthlyFine").value);
    const currency = document.getElementById("currency").value;
    const resultDiv = document.getElementById("result");

    if (isNaN(purchaseDate) || purchaseDate > targetDate) {
        resultDiv.innerText = "âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØªØ§Ø±ÙŠØ® ØµØ­ÙŠØ­";
        return;
    }
    if (isNaN(monthlyFine)) {
        resultDiv.innerText = "âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº Ø§Ù„ØºØ±Ø§Ù…Ø©";
        return;
    }
    if (currency === "USD" && isNaN(rate)) {
        resultDiv.innerText = "âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±";
        return;
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø¨Ø§Ù„Ø£Ø´Ù‡Ø± ÙˆØ§Ù„Ø£ÙŠØ§Ù…
    let months = 0;
    let temp = new Date(purchaseDate);
    while (temp < targetDate) {
        temp.setMonth(temp.getMonth() + 1);
        if (temp <= targetDate) months++;
        else {
            temp.setMonth(temp.getMonth() - 1);
            break;
        }
    }
    let days = Math.floor((targetDate - temp) / (1000 * 60 * 60 * 24));

    // Ø®ØµÙ… 18 Ø´Ù‡Ø±
    let fineMonths = months - 18;
    if (fineMonths < 0) fineMonths = 0;
    let fineDays = fineMonths * 30 + days;

    // Ø§Ù„ØºØ±Ø§Ù…Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
    let dailyFine = monthlyFine / 30;
    if (currency === "USD") {
        dailyFineIQD = dailyFine * rate;
    } else {
        dailyFineIQD = dailyFine;
    }

    baseAmount = fineDays * dailyFineIQD;

    resultDiv.innerHTML = `
        â³ <strong>Ø§Ù„ÙØ±Ù‚ Ø§Ù„ÙƒÙ„ÙŠ</strong><br>
        <span class="note">(Ù…Ù† ØªØ§Ø±ÙŠØ® ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯ Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ® 1/1/2026)</span><br>
        Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø±: ${months} Ø´Ù‡Ø± &nbsp;|&nbsp; Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…: ${days} ÙŠÙˆÙ…<br><br>

        âš ï¸ <strong>Ù…Ø¯Ø© Ø§Ù„ØºØ±Ø§Ù…Ø§Øª Ø¨Ø¹Ø¯ Ø®ØµÙ… 18 Ø´Ù‡Ø±</strong>: ${fineDays} ÙŠÙˆÙ…<br>
        ğŸ’° <strong>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</strong>: ${baseAmount.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±
    `;

    document.getElementById("stopSection").style.display = "block";
}

function applyStopDays() {
    const stopDays = parseInt(document.getElementById("stopDays").value);
    const finalDiv = document.getElementById("finalResult");

    let stopAmount = stopDays * dailyFineIQD;
    let finalAmount = baseAmount - stopAmount;
    if (finalAmount < 0) finalAmount = 0;

    finalDiv.innerHTML = `
        ğŸ’¸ Ø®ØµÙ… Ø£ÙŠØ§Ù… Ø§Ù„ØªÙˆÙ‚Ù: ${stopAmount.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±<br>
        âœ… <strong>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚</strong>: ${finalAmount.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±
    `;
}
</script>

</body>
</html>